# Technical Decisions (기술 결정 기록)

프로젝트의 주요 기술 결정사항을 기록합니다.

---

## 결정 기록 형식

```markdown
## [DEC-XXX] 제목

**날짜**: YYYY-MM-DD
**상태**: 승인 | 보류 | 폐기
**관련 파일**: 파일 목록

### 배경
왜 이 결정이 필요했는가?

### 결정
무엇을 결정했는가?

### 대안
검토했던 다른 방안들

### 결과
이 결정의 영향
```

---

## [DEC-001] 탭 구조 변경 (4탭 → 5탭)

**날짜**: 2025-12-26
**상태**: 승인
**관련 파일**: `app/(tabs)/_layout.tsx`, `app/(tabs)/calendar.tsx`, `app/(tabs)/records.tsx`

### 배경
- 기존 4탭: Todo | Learn | Game | Settings
- Game 탭이 앱의 핵심 기능과 맞지 않음
- 캘린더와 기록 열람 기능 필요

### 결정
5탭 구조로 변경:
```
오늘 | 캘린더 | 학습 | 기록 | 설정
```

- **오늘**: 당일 Todo + 빠른 메모 + 오늘 요약
- **캘린더**: 월별 캘린더 + 날짜별 활동 마커
- **학습**: 영어 학습 (레벨/주차별)
- **기록**: 과거 기록 열람 + 검색
- **설정**: 앱 설정 + 미니게임 접근

### 대안
1. 4탭 유지 + Game을 Settings 하위로 → 탭 수 제한되어 확장 어려움
2. 6탭 (캘린더, 기록 분리) → 너무 많은 탭
3. 하단 탭 4개 + 상단 탭 → UX 복잡

### 결과
- Game은 `app/game.tsx`로 이동 (탭에서 제거)
- 캘린더와 기록 탭 신규 생성
- 더 직관적인 일상 기록 앱 구조

---

## [DEC-002] 2048 게임 위치 변경

**날짜**: 2025-12-26
**상태**: 승인
**관련 파일**: `app/(tabs)/game.tsx` → `app/game.tsx`

### 배경
- 2048 게임이 탭 중 하나를 차지
- 영어 학습 앱에서 게임이 메인 기능은 아님
- 보상 시스템으로 활용하면 의미 있음

### 결정
- 게임을 탭에서 제거
- 설정 화면에서 접근 가능하도록 변경
- 향후 "별 N개 사용하여 게임하기" 보상 시스템 연동

### 대안
1. 게임 완전 제거 → 사용자 재미 요소 상실
2. 학습 완료 후에만 잠금 해제 → 너무 제한적

### 결과
- 탭 공간 확보
- 게임은 부가 기능으로 유지
- 향후 보상 시스템과 연동 가능

---

## [DEC-003] 학습 구조 변경 (8주 → 레슨 기반)

**날짜**: 2025-12-26
**상태**: 보류 (Phase 2에서 진행)
**관련 파일**: `store/learnStore.ts`, `data/activities/**`

### 배경
- 현재: 8주 × 6영역 고정 구조
- 문제점:
  - 8주가 끝나면 다음 단계 불명확
  - 학습 속도에 맞지 않는 경직된 구조
  - 테스트 시스템 부재

### 결정
레슨 기반 구조로 전환:
```
레벨 (A1-C2)
└── 레슨 1, 2, 3... (40-60개)
    └── 6개 영역 (vocabulary, grammar, ...)
```

### 테스트 시스템
1. **진단 테스트**: 앱 시작 시 레벨 결정
2. **레슨 테스트**: 레슨 완료 조건 (80% 이상)
3. **승급 테스트**: 레벨 업 조건
4. **정기 테스트**: 주기적 리텐션 체크

### 대안
1. 8주 구조 유지 → 확장성 부족
2. 완전 자유 구조 → 학습 가이드 부재

### 결과
- 유연한 학습 진행
- 명확한 목표와 피드백
- 데이터 마이그레이션 필요 (기존 288개 활동 유지)

---

## [DEC-004] moti 라이브러리 유지

**날짜**: 2025-12-26
**상태**: 승인 (임시)
**관련 파일**: `components/shared/StarDisplay.tsx`, `StreakRing.tsx`, `EmptyState.tsx`, `Toast.tsx`, `LoadingSpinner.tsx`

### 배경
- moti는 Reanimated 4 미지원 (SDK 54에서 문제)
- 현재 SDK 51 사용 중
- 5개 파일에서 moti 사용

### 결정
- SDK 54 업그레이드 전까지 moti 유지
- 업그레이드 시 react-native-reanimated로 마이그레이션

### 마이그레이션 계획
```tsx
// moti (현재)
<MotiView animate={{ opacity: 1 }} />

// reanimated (향후)
const opacity = useSharedValue(0);
<Animated.View style={animatedStyle} />
```

### 대안
1. 지금 바로 마이그레이션 → 불필요한 작업량
2. moti 포크하여 수정 → 유지보수 부담

### 결과
- 현재는 안정적으로 동작
- SDK 54 업그레이드 시 함께 처리

---

## [DEC-005] AsyncStorage 기반 오프라인 우선

**날짜**: 2025-12-25 (기존 결정)
**상태**: 승인
**관련 파일**: 모든 store/*.ts

### 배경
- 타겟: 한국인 영어 학습자
- 지하철, 오프라인 환경에서도 사용 필요
- 서버 비용 최소화

### 결정
- 모든 데이터 AsyncStorage 저장
- Zustand persist 미들웨어 사용
- 클라우드 동기화는 향후 옵션

### 대안
1. Firebase 사용 → 온라인 필수, 비용 발생
2. SQLite → 복잡한 쿼리 불필요, 오버엔지니어링

### 결과
- 완전 오프라인 동작
- 빠른 앱 시작
- 백업/복원으로 데이터 보존

---

## [DEC-006] Day 중심 데이터 모델

**날짜**: 2025-12-25 (기존 결정)
**상태**: 승인
**관련 파일**: `types/day.ts`, `utils/day.ts`

### 배경
- Todo, 학습, 일기가 각각 별도 Store
- 날짜별 통합 뷰 필요
- 캘린더, 기록 화면에서 날짜별 데이터 필요

### 결정
DayData 타입으로 통합:
```typescript
interface DayData {
  date: string;           // YYYY-MM-DD
  todos: Task[];          // 해당 날짜 Todo
  diary: DiaryEntry | null;
  learnProgress: ActivityProgress[];
  note: string | null;    // 한 줄 기록
}
```

### 대안
1. 각 Store에서 직접 필터링 → 중복 로직, 성능 저하
2. 별도 DayStore 생성 → Store 중복

### 결과
- 유틸리티 레이어로 통합
- 기존 Store 구조 유지
- 효율적인 날짜별 데이터 조회

---

## 결정 목록 요약

| ID | 제목 | 상태 | 날짜 |
|----|------|------|------|
| DEC-001 | 탭 구조 변경 (5탭) | 승인 | 2025-12-26 |
| DEC-002 | 2048 게임 위치 변경 | 승인 | 2025-12-26 |
| DEC-003 | 학습 구조 변경 (레슨 기반) | 보류 | 2025-12-26 |
| DEC-004 | moti 라이브러리 유지 | 승인 (임시) | 2025-12-26 |
| DEC-005 | AsyncStorage 오프라인 우선 | 승인 | 2025-12-25 |
| DEC-006 | Day 중심 데이터 모델 | 승인 | 2025-12-25 |
